********************************************************************************                                
                            |           |                                      |
                            |   STRUCT  |                                      |
                            |           |                                      |
********************************************************************************
                                                                               |
t_db_message: використовується для передачі даних про повідомлення             |
    guint64 user_id     -> id користувача який відправив повідомлення          |
    guint64 room_id     -> id кімнати в яку було надіслано повідомлення        |
    guint64 message_id  -> унікальний номер повідомлення                       |
    guint64 date        -> час відправлення повідомлення в мілісекундах        |
    gint8 status        -> статус повідомлення DB_STATUS_MSG_EDIT or           |
                           DB_STATUS_MSG_START (при створенні повідомлення     |
                           ставиться дефолне значення DB_STATUS_MSG_START)     |
    gint8 type          -> тип повідомлення DB_TEXT_MSG or DB_FILE_MSG or      |
                           DB_FILE_TEXT_MSG залежить від того що містить       |
                           дане повідомлення                                   |
    guint64 file_size   -> якщо тип повідомлення DB_FILE_MSG or                |
                           DB_FILE_TEXT_MSG записується розмір файлу           |
    gchar *message      -> якщо тип повідомлення DB_TEXT_MSG or                |
                           DB_FILE_TEXT_MSG зберігає текстове повідомлення     |
    gchar *file_name    -> якщо тип повідомлення DB_FILE_MSG or                |
                           DB_FILE_TEXT_MSG зберігає ім'я файлу                |
                                                                               |
********************************************************************************
                                                                               |
t_db_room: використовується для передачі даних про чат_кімнату                 |
    guint64 date        -> час створення кімнати в мілісекундах                |
    guint64 room_id     -> унікальний номер кімнати                            |
    guint64 customer_id -> id користувача який створив кімнату                 |
    gint8 type          -> тип кімнати DB_PRIVAT_CHAT or                       |
                           DB_GLOBAL_CHAT or DB_TWO_CHAT                       |
    gchar *desc         -> опис кімнати                                        |
    gchar *room_name    -> назва кімнати                                       |
                                                                               |
********************************************************************************
                                                                               |
t_db_user: використовується для передачі даних про користувача                 |
    guint64 user_id -> унікальний номер користувача                            |
    guint64 date    -> час реєстарції користувача в мілісекундах               |
    gchar *pass     -> зашифрований пароль користувача                         |
    gchar *token    -> унікальний token користувача я незнаю для чого він      |
    gchar *name     -> ім'я користувача                                        |
    gchar *login    -> унікальний login користувача використовується для входу |
    gchar *desc     -> опис користувача                                        |
                                                                               |
********************************************************************************
                                                                               |
t_db_members: використовується для передачі даних про кімнату в якій           |
              знахожиться користувач                                           |
    guint64 user_id -> id користувача який знаходиться в даній кімнаті         |
    guint64 room_id -> id кімнати в якій знаходиться даний користувач          |
    guint64 date    -> час входження користувача до даної кімнати              |
    gint8   prm     -> права які має даний користувач в даній кімнаті          |
                                                                               |
********************************************************************************
                            |               |                                  |
                            |    FUNCTION   |                                  |
                            |               |                                  |
********************************************************************************
                                                                               |
mx_open_db(MX_DB)                                                              |
                                                                               |
argument: назву файлу з даними;                                                |
description: відкриває файловий дескриптор сервера з базою даних;              |
return value: (sqlite3 *);                                                     |
error handling: вирубає сервер якщо невдалося відкрити звязок;                 |
                                                                               |
********************************************************************************
                                                                               |
mx_close_db(sqlite3 *)                                                         |
                                                                               |
argument: відкритий файловий дескриптор                                        |
description: перериває звязок з базою даних, закриває файловий дескриптор      |
return: -                                                                      |
error: write to loger                                                          |
                                                                               |
********************************************************************************
                        |                   |                                  |
                        |   FUNCTION ROOM   |                                  |
                        |                   |                                  |
********************************************************************************
                                                                               |
mx_edit_desc_room_by_id(sqlite3 *, guint64 room_id, gchar *new)                |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 room_id)   -> id кімнати                                          |
    (guint64 new)       -> новий description                                   |
description: змінює desc кімнати                                               |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_delete_room_by_id(sqlite3 *, guint64 id)                                    |
                                                                               |
argument:                                                                      |
    (sqlite3 *)     -> відкрий дескриптор бази даних                           |
    (guint64 id)    -> id кімнати                                              |
description: видаляє кімнату                                                   |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_free_room(t_db_room **room)                                                 |
                                                                               |
argument:                                                                      |
    (t_db_room **room) -> структура                                            |
description: очищає дану структуру                                             |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_count_rooms(sqlite3 *)                                                  |
                                                                               |
argument:                                                                      |
    (sqlite3 *) -> відкрий дескриптор бази даних                               |
description: визначає та повертає кількість кімнат                             |
return value: guint64                                                          |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_parse_room(cJSON *)                                                         |
                                                                               |
argument:                                                                      |
    (cJSON *) -> строка у json форматі                                         |
description: розбиває на поля та записує дані в структуру t_db_room            |
return value: частково заповнена структура t_db_room або NULL(при помилці)     |
error handling: -                                                              |
                                                                               |
********************************************************************************
                                                                               |
mx_insert_room_into_db(sqlite3 *, t_db_room *)                                 |
                                                                               |
argument:                                                                      |
    (sqlite3 *)     -> відкрий дескриптор бази даних                           |
    (t_db_room *)   -> структура з частиною даних про кімнату яку можна        |
                        отримати з json строки за допомогою функції            |
                        mx_parse_room()                                        |
                        дивитись опис цієї функції нижче                       |
description: записує дані про кімнату в базу даних                             |
return value: (заповнює/не заповнює) структуру t_db_room(після використання    |
              її потрібно очистити функцією mx_free_room())                    |
error handling : записує в loger                                               |
                                                                               |
********************************************************************************
                                                                               |
mx_search_room(sqlite3 *, gchar *str_search)                                   |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (gchar *str_search) -> частина строчки яку потрібно знайти                 |
description: шукає кімнати в базі даних та повертає json масив об'єктів з      |
             знайденими результатами                                           |
return value: сJSON*                                                           |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_edit_room_name_by_id(sqlite3 *, guint64 id, gchar *new_name)                |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 id)        -> id кімнати                                          |
    (guint64 new_name)  -> нове ім'я                                           |
description: змінює ім'я кімнати                                               |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_rooms(sqlite3 *, guint64 date, guint64 user_id)                         |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 *date)     -> кімнати які були зареєстровані до даного часу       |
                           не будуть заноситись в результатат                  |
    (guint64 user_id)   -> будуть вибрані тільки кімнати даного користувача    |
description: збирає дані про кімнати даного користувача зареєстрованих після   |
             даної дати та заносить їх в строку json формату                   |
             (масив json з json об'єктами)                                     |
return value: cJSON*                                                           |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_room_by_id(sqlite3 *, guint64 room_id)                                  |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 *room_id)  -> id кімнати яку потрібно знайти                      |
description: шукає кімнату та в разі успіху повертає структуру t_db_room       |
return value: t_db_room *, NULL(якщо кімнати не було знайдено)                 |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                        |                      |                               |
                        |   FUNCTION MESSAGE   |                               |
                        |                      |                               |
********************************************************************************
                                                                               |
mx_edit_message_by_id(sqlite3 *, guint64 id, gchar *new)                       |
                                                                               |
argument:                                                                      |
    (sqlite3 *)     -> відкрий дескриптор бази даних                           |
    (guint64 id)    -> id повідомлення                                         |
    (guint64 new)   -> нове повідомлення                                       |
description: змінює повідомлення                                               |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_delete_message_by_id(sqlite3 *, guint64 id)                                 |
                                                                               |
argument:                                                                      |
    (sqlite3 *)     -> відкрий дескриптор бази даних                           |
    (guint64 id)    -> id повідомлення                                         |
description: видаляє повідомлення                                              |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_free_message(t_db_message **message)                                        |
                                                                               |
argument:                                                                      |
    (t_db_message **message)   ->  структура                                   |
description: очищає дану структуру                                             |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_parse_message(cJSON *)                                                      |
                                                                               |
mx_get_count_messages(sqlite3 *, guint64 room_id)                              |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 room_id)   -> id кімнати з якої потріюно взяти                    |
                           кількість повідомлень                               |
description: визначає та повертає кількість повідомлень                        |
return value: guint64                                                          |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
argument:                                                                      |
    (cJSON *) -> строка у json форматі                                         |
description: розбиває на поля та записує дані в структуру t_db_message         |
return value: частково заповнена структура t_db_message або NULL(при помилці)  |
error handling: -                                                              |
                                                                               |
********************************************************************************
                                                                               |
mx_insert_message_into_db(sqlite3 *, t_db_message *)                           |
                                                                               |
argument:                                                                      |
    (sqlite3 * )    -> відкрий дескриптор бази даних                           |
    (t_db_message *)-> структура з частиною даних про повідомлення яку можна   |
                       отримати з json строки за допомогою функції             |
                       mx_parse_message()                                      |
                       дивитись опис цієї функції нижче                        |
description: записує дані про повідомлення в базу даних                        |
return value: (заповнює/не заповнює) структуру t_db_message(після використання |
              її потрібно очистити функцією mx_free_message())                 |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_curr_messages_by_id(sqlite3 *, guint64 room_id, gint64 count)           |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 room_id)   -> id кімнати з якої будуть взяті повідомлення         |
    (guint64 count)     -> кількість повідомленнь які потрібно взяти           |
description: збирає дані про останні повідомлення даної кімнати                |
             та заносить їх в строку json формату                              |
             (об'єкт з полем room_id та масивом messages)                      |
return value: cJSON*                                                           |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_old_messages_by_id(sqlite3 *, guint64 room_id, guint64 date,            |
                          gint64 count)                                        |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 room_id)   -> id кімнати з якої будуть взяті повідомлення         |
    (guint64 date)      -> час в мілісекундах меседжі створенні                |
                           після якого не будуть враховуватись                 |
    (guint64 count)     -> кількість повідомленнь які потрібно взяти           |
description: збирає дані про повідомлення даної кімнати доданих до             |
             даної дати та заносить їх в строку json формату                   |
             (об'єкт з полем room_id та масивом messages)                      |
return value: cJSON*                                                           |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_new_messages_by_id(sqlite3 *, guint64 room_id, guint64 date,            |
                          gint64 count)                                        |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 room_id)   -> id кімнати з якої будуть взяті повідомлення         |
    (guint64 date)      -> час в мілісекундах меседжі створенні                |
                           до якого не будуть враховуватись                    |
    (guint64 count)     -> кількість повідомленнь які потрібно взяти           |
description: збирає дані про повідомлення даної кімнати доданих після          |
             даної дати та заносить їх в строку json формату                   |
             (об'єкт з полем room_id та масивом messages)                      |
return value: cJSON*                                                           |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                        |                   |                                  |
                        |   FUNCTION USER   |                                  |
                        |                   |                                  |
********************************************************************************
                                                                               |
mx_edit_token(sqlite3 *, guint64 user_id, gchar *new)                          |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 user_id)   -> id користувача                                      |
    (guint64 new)       -> новий token                                         |
description: змінює token користувача                                          |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_edit_desc_user(sqlite3 *, guint64 user_id, gchar *new)                      |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 user_id)   -> id користувача                                      |
    (guint64 new)       -> новий description                                   |
description: змінює desc користувача                                           |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_edit_permission_of_user(sqlite3 *, guint64 user_id, guint64 room_id,        |
                                 gint8 new)                                    |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 user_id)   -> id користувача                                      |
    (guint64 room_id)   -> id кімнати                                          |
    (guint64 new)       -> новий параметр прав                                 |
description: змінює права доступу в користувача в кімнаті                      |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_delete_user_by_id(sqlite3 *, guint64 id)                                    |
                                                                               |
argument:                                                                      |
    (sqlite3 *)     -> відкрий дескриптор бази даних                           |
    (guint64 id)    -> id користувача                                          |
description: вбиває користувача                                                |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_free_user(t_db_user **user)                                                 |
                                                                               |
argument:                                                                      |
    (t_db_user **user) -> структура                                            |
description: очищає дану структуру                                             |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_count_users(sqlite3 *)                                                  |
                                                                               |
argument:                                                                      |
    (sqlite3 *) -> відкрий дескриптор бази даних                               |
description: визначає та повертає кількість користувачів                       |
return value: guint64                                                          |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_insert_user_into_db(sqlite3 *, t_db_user *)                                 |
                                                                               |
argument:                                                                      |
    (sqlite3 *)     -> відкрий дескриптор бази даних                           |
    (t_db_user *)   -> структура з частиною даних про кімнату яку можна        |
                       отримати з json строки за допомогою функції             |
                       mx_parse_user()                                         |
                       дивитись опис цієї функції нижче                        |
description: записує дані про кімнату в базу даних                             |
return value: (заповнює/не заповнює) структуру t_db_user(після використання    |
              її потрібно очистити функцією mx_free_user())                    |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_parse_user(cJSON *)                                                         |
                                                                               |
argument:                                                                      |
    (cJSON *) -> строка у json форматі                                         |
description: розбиває на поля та записує дані в структуру t_db_user            |
return value: частково заповнена структура t_db_user або NULL;                 |
error handling: -                                                              |
                                                                               |
********************************************************************************
                                                                               |
mx_edit_user_name_by_id(sqlite3 *, guint64 id, gchar *new_name)                |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 id)        -> id користувача ім'я якого потрібно змінити          |
    (guint64 new_name)  -> нове ім'я                                           |
description: змінює ім'я користувача                                           |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_users(sqlite3 *, guint64 date)                                          |
                                                                               |
argument:                                                                      |
    (sqlite3 *)     -> відкрий дескриптор бази даних                           |
    (guint64 *date) -> користувачі які були зареєстровані до даного часу       |
                       не будуть заноситись в результатат                      |
description: збирає дані про користувачів зареєстрованих після даної дати та   |
             заносить їх в строку json формату(масив json з json об'єктами)    |
return value: cJSON*                                                           |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_user_by_token(sqlite3 *, gchar *token)                                  |
                                                                               |
argument:                                                                      |
    (sqlite3 *)     -> відкрий дескриптор бази даних                           |
    (gchar *token)  -> token користувача якого потрібно знайти                 |
description: шукає користувача та в разі успіху повертає структуру t_db_user   |
return value: t_db_user *, NULL(якщо користувача не було знайдено)             |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_user_by_id(sqlite3 *, guint64 user_id)                                  |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 user_id)   -> id користувача якого потрібно знайти                |
description: шукає користувача та в разі успіху повертає структуру t_db_user   |
return value: t_db_user *, NULL(якщо користувача не було знайдено)             |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_user_by_login(sqlite3 *, gchar *login)                                  |
                                                                               |
argument:                                                                      |
    (sqlite3 *)     -> відкрий дескриптор бази даних                           |
    (gchar *login)  -> login користувача якого потрібно знайти                 |
description: шукає користувача та в разі успіху повертає структуру t_db_user   |
return value: t_db_user *, NULL(якщо користувача не було знайдено)             |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_search_user(sqlite3 *db, gchar *str_search)                                 |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (gchar *str_search) -> частина строчки яку потрібно знайти                 |
description: шукає користувачів в базі даних та повертає json масив об'єктів з |
             знайденими результатами                                           |
return value: сJSON*                                                           |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_check_user_by_login(sqlite3 *db, gchar *login)                              |
                                                                               |
argument:                                                                      |
    (sqlite3 *)     -> відкрий дескриптор бази даних                           |
    (gchar *login)  -> частина строчки яку потрібно знайти                     |
description: шукає користувачів в базі даних та повертає json масив об'єктів з |
             знайденими результатами                                           |
return value: сJSON*                                                           |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                        |                     |                                |
                        |   FUNCTION MEMBER   |                                |
                        |                     |                                |
********************************************************************************
                                                                               |
mx_insert_member_into_db(sqlite3 *, guint64 room, guint64 user, gint8 perm)    |
                                                                               |
argument:                                                                      |
    (sqlite3 *)     -> відкрий дескриптор бази даних                           |
    (guint64 room)  -> id кімнати в якій знаходиться даний користувач          |
    (guint64 user)  -> id користувача який знаходиться в даній кімнати         |
    (guint8  perm)  -> права які має користувач в даній кімнаті                |
description: записує дані про наявність користувача в кімнаті                  |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                        |                    |                                 |
                        |   FUNCTION OTHER   |                                 |
                        |                    |                                 |
********************************************************************************
                                                                               |
mx_get_time(gint8 type)                                                        |
                                                                               |
argument:                                                                      |
    (gint8 type) -> одиниці вимірювання часу DB_SECOND,                        |
                    DB_MILISECOND, DB_MICROSECOND                              |
description: визначає поточний час в заданих одиницях                          |
return value: час в форматі guint64                                            |
error handling: -                                                              |
                                                                               |
********************************************************************************
                        |                    |                                 |
                        |   FUNCTION QUEUE   |                                 |
                        |                    |                                 |
********************************************************************************
                                                                               |
mx_db_push_queue_by_id(sqlite3 *, guint64 user_id, gchar *request)             |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 user_id)   -> id користувача запрос якого заноситься в базу даних |
    (gchar *request)    -> запрос який порібно зберегти в базі даних           |
description: заносить в базу даних запрос                                      |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_db_pop_queue_by_id(sqlite3 *, guint64 user_id, gchar *request)              |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 user_id)   -> id користувача запрос якого видаляється             |
description: видаляє перший запрос даного користувача                          |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_get_queue(sqlite3 *, guint64 user_id)                                       |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 user_id)   -> id користувача запрося якого потрібно взяти з бд    |
description: дістає та повертає перший запрос який був записаний користувачем  |
return value: gchar*, NULL(при помилці)                                        |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************
                                                                               |
mx_clean_queue(sqlite3 *db, guint64 user_id)                                   |
                                                                               |
argument:                                                                      |
    (sqlite3 *)         -> відкрий дескриптор бази даних                       |
    (guint64 user_id)   -> id користувача запроси якого потрібно видалити      |
description: видаляє всі запроси користувача                                   |
return value: -                                                                |
error handling: записує в loger                                                |
                                                                               |
********************************************************************************

